<project name="GanttProject builder">
    <target name="dist-deb" description="Builds DEB package" depends="make-package-name">
        <ant antfile="build-deb.xml" inheritall="false">
            <property name="package-version" value="${package.name.suffix}"></property>
        </ant>
        <copy todir="." file="${deb.dir}/${package.name.prefix}_${package.name.suffix}-1_all.deb"></copy>
    </target>

    <taskdef name="bundleapp"
             classname="com.oracle.appbundler.AppBundlerTask"
             classpath="lib/appbundler-1.0.jar"/>

    <target name="distMac" depends="distBin">
        <mkdir dir="${distMacOut}"/>
        <bundleapp outputdirectory="${distMacOut}"
                   name="GanttProject"
                   displayname="GanttProject"
                   identifier="net.sourceforge.ganttproject"
                   shortversion="${version}"
                   icon="ganttproject.icns"
                   copyright="Copyright 2017 BarD Software s.r.o. Distributed under GPL3"
                   applicationCategory="public.app-category.productivity"
                   mainclassname="org.bardsoftware.eclipsito.Boot">

            <classpath file="eclipsito.jar"/>
            <argument value="-app"/>
            <argument value="net.sourceforge.ganttproject.GanttProject"/>
            <argument value="-plugins-dir"/>
            <argument value="$APP_ROOT/Contents/Java/plugins"/>
            <argument value="-log"/>
            <argument value="true"/>
            <option value="-Dapple.laf.useScreenMenuBar=true"/>
            <option value="-Dcom.apple.mrj.application.apple.menu.about.name=GanttProject"/>
            <option value="-Xdock:name=GanttProject"/>
            <option value="-Xmx512m"/>
            <option value="-ea"/>
        </bundleapp>
        <copy todir="${distMacOut}/GanttProject.app/Contents/Java">
            <fileset dir="${distBin}">
                <include name="eclipsito.jar"/>
                <include name="plugins/**"/>
                <include name="logging.properties"/>
            </fileset>
        </copy>
        <patch patchfile="Info.plist.patch" originalfile="${distMacOut}/GanttProject.app/Contents/Info.plist"/>
        <chmod perm="ugo+rx" file="${distMacOut}/GanttProject.app/Contents/MacOS/JavaAppLauncher"></chmod>
        <zip destfile="${distMacZip}">
            <zipfileset dir="${distMacOut}" includes="GanttProject.app/**">
            </zipfileset>
        </zip>
    </target>
</project>
